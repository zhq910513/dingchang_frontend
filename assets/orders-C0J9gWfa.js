import{h as d}from"./http-CBIyYC5i.js";const c="Asia/Shanghai";function f(n){const e=Number(typeof n=="string"?n.trim():n);if(!Number.isFinite(e))throw new Error("orders api: invalid id");if(!Number.isInteger(e))throw new Error("orders api: id must be an integer");if(e<=0)throw new Error("orders api: invalid id");return e}function a(n){const e={};for(const[r,t]of Object.entries(n||{}))t!==void 0&&(e[r]=t);return e}function u(n){return n instanceof Date&&Number.isFinite(n.getTime())}function _(n,e=c){const r=u(n)?n:new Date(n);return u(r)?new Intl.DateTimeFormat("en-CA",{timeZone:e,year:"numeric",month:"2-digit",day:"2-digit"}).format(r):""}function p(n){if(n==null)return"";if(u(n))return _(n,c);if(typeof n=="string"){const r=n.trim();if(!r)return"";if(/^\d{8}$/.test(r))return`${r.slice(0,4)}-${r.slice(4,6)}-${r.slice(6,8)}`;const t=r.match(/^(\d{4}-\d{2}-\d{2})/);if(t)return t[1];const i=r.match(/^(\d{4})\/(\d{2})\/(\d{2})/);return i?`${i[1]}-${i[2]}-${i[3]}`:r}return String(n).trim()||""}function m(n){if(!Array.isArray(n)||n.length!==2)return null;const e=p(n[0]),r=p(n[1]);return!e||!r?null:[e,r]}function g(n){const e={},r=n&&typeof n=="object"?n:{};for(const[t,i]of Object.entries(r))if(i!=null){if(typeof i=="string"){const o=i.trim();if(!o)continue;e[t]=o;continue}if(typeof i=="number"){if(!Number.isFinite(i))continue;e[t]=i;continue}if(u(i)){e[t]=_(i,c);continue}if(Array.isArray(i)){const o=i.map(s=>s==null?s:typeof s=="string"?s.trim():typeof s=="number"?Number.isFinite(s)?s:null:u(s)?_(s,c):s).filter(s=>s!=null&&!(typeof s=="string"&&s===""));if(!o.length)continue;e[t]=o;continue}e[t]=i}return e}function y(n){const e=g(n);if(Object.prototype.hasOwnProperty.call(e,"created_date")){const t=Object.prototype.hasOwnProperty.call(e,"created_date_start"),i=Object.prototype.hasOwnProperty.call(e,"created_date_end"),o=!t&&!i?m(e.created_date):null;delete e.created_date,o&&(e.created_date_start=o[0],e.created_date_end=o[1])}if(Object.prototype.hasOwnProperty.call(e,"first_register_date")){const t=Object.prototype.hasOwnProperty.call(e,"first_register_date_start"),i=Object.prototype.hasOwnProperty.call(e,"first_register_date_end"),o=!t&&!i?m(e.first_register_date):null;delete e.first_register_date,o&&(e.first_register_date_start=o[0],e.first_register_date_end=o[1])}const r=[["created_date_start","created_date_end"],["first_register_date_start","first_register_date_end"]];for(const[t,i]of r){const o=Object.prototype.hasOwnProperty.call(e,t)&&String(e[t]??"").trim()!=="",s=Object.prototype.hasOwnProperty.call(e,i)&&String(e[i]??"").trim()!=="";o!==s&&(delete e[t],delete e[i])}return e}function S(n={}){const e=y(n);return d.get("/orders",{params:e})}function w(n){const e=f(n);return d.get(`/orders/${e}`)}function j(n={}){const e=a({module:n.module||"order",dynamic_data:n.dynamic_data||{},image_urls:n.image_urls||[],salesperson_id:n.salesperson_id??void 0,customer_group_id:n.customer_group_id??void 0,channel_group_id:n.channel_group_id??void 0,is_finished:n.is_finished??void 0,is_rebate:n.is_rebate??void 0,is_paid:n.is_paid??void 0,order_info:n.order_info??void 0});return d.post("/orders",e)}function z(n={}){const e=a({module:n.module||"order",dynamic_data:n.dynamic_data||{},customer_group_id:n.customer_group_id??void 0,channel_group_id:n.channel_group_id??void 0,salesperson_id:n.salesperson_id??void 0});return d.post("/orders/draft",e)}function h(n){if(!Array.isArray(n))return[];const e=[];for(const r of n){if(!r||typeof r!="object")continue;const t=r.slot_key!=null?String(r.slot_key).trim():"",i=r.storage_key!=null?String(r.storage_key).trim().replace(/^\/+/,""):"",o=r.md5!=null?String(r.md5).trim():"";if(!t||!i)continue;const s={slot_key:t,storage_key:i,md5:o};if(r.etag!=null&&String(r.etag).trim()&&(s.etag=String(r.etag).trim()),r.size!=null&&!Number.isNaN(Number(r.size))){const l=Number(r.size);s.size=Number.isFinite(l)?Math.max(0,l):0}r.content_type!=null&&String(r.content_type).trim()&&(s.content_type=String(r.content_type).trim()),r.original_name!=null&&String(r.original_name).trim()&&(s.original_name=String(r.original_name).trim()),r.url!=null&&String(r.url).trim()&&(s.url=String(r.url).trim()),e.push(s)}return e}function b(n){if(!Array.isArray(n))return[];const e=new Set(["related"]),r=new Set,t=[];for(const i of n){const o=String(i??"").trim();o&&e.has(o)&&(r.has(o)||(r.add(o),t.push(o)))}return t}function N(n={}){const e=n&&typeof n=="object"?n:{},r=b(e.clear_slots),t=h(e.images),i=a({order_id:e.order_id!=null?f(e.order_id):void 0,images:t,clear_slots:r.length?r:void 0,dynamic_data:e.dynamic_data??void 0,customer_group_id:e.customer_group_id??void 0,channel_group_id:e.channel_group_id??void 0,salesperson_id:e.salesperson_id??void 0});return d.post("/orders/finalize",i)}function P({slot_key:n,file:e}){const r=new FormData;return r.append("slot_key",String(n||"").trim()),r.append("file",e),d.post("/orders/bos-upload",r)}function A(n,e={}){const r=f(n),t=a({module:e.module??void 0,dynamic_data:e.dynamic_data!==void 0?e.dynamic_data:void 0,status:e.status!==void 0?e.status:void 0,audit_status:e.audit_status!==void 0?e.audit_status:void 0,image_urls:e.image_urls!==void 0?e.image_urls:void 0,is_finished:e.is_finished!==void 0?e.is_finished:void 0,is_rebate:e.is_rebate!==void 0?e.is_rebate:void 0,is_paid:e.is_paid!==void 0?e.is_paid:void 0,customer_group_id:e.customer_group_id!==void 0?e.customer_group_id:void 0,channel_group_id:e.channel_group_id!==void 0?e.channel_group_id:void 0,salesperson_id:e.salesperson_id!==void 0?e.salesperson_id:void 0,order_info:e.order_info!==void 0?e.order_info:void 0});return d.put(`/orders/${r}`,t)}function $(n,e={}){const r=f(n),t=a({is_finished:e.is_finished!==void 0?e.is_finished:void 0});return d.patch(`/orders/${r}/status`,t)}function k(){return d.get("/orders/customer-groups")}function F(){return d.get("/orders/channel-groups")}export{A as a,$ as b,z as c,k as d,F as e,N as f,w as g,j as h,S as l,P as u};

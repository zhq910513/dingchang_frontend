import{b as h,u as ee}from"./vendor-vue-router-CVyACjsp.js";import{a as te}from"./auth-9daRAOLC.js";import{_ as se,u as ae,R as _}from"./index-D0GAttcT.js";import{m as B,E as k}from"./vendor-element-plus-CtVxZ4Oy.js";import{c as u,r as D,q as le,Y as ne,o as de,G as g,H as t,ay as r,y as w,P as s,z as a,u as f,L as i,x as ie,J as U,M as O,C}from"./vendor-vue-fFWwKrgY.js";import"./http-CBIyYC5i.js";import"./vendor-axios-C0Zqfgkc.js";import"./vendor-pinia-CMXa-Za0.js";import"./vendor-lodash-rvV0CIkQ.js";import"./vendor-DWCz07M-.js";import"./vendor-dates-DVKSwKij.js";const oe={class:"header-left"},ue={class:"header-title"},re={class:"header-right"},fe={class:"who"},ve={key:0,class:"mobile-bottom-nav"},pe={__name:"Dashboard",setup(me){const y=h(),o=ee(),A=ae(),m=u(()=>String(A.roleName||"").trim().toLowerCase()),F=u(()=>m.value===_.FINANCE),P=u(()=>m.value===_.SALES),T=u(()=>m.value===_.MARKET),G=u(()=>m.value===_.SUPER_ADMIN),H=u(()=>A.displayName),d=u(()=>!F.value),E=u(()=>d.value&&!T.value),S=u(()=>!P.value),M=u(()=>m.value===_.SUPER_ADMIN||m.value===_.MANAGER),c=u(()=>G.value),v=D(!1),b=D(!1);function W(){v.value=typeof window<"u"&&window.innerWidth<=768,v.value||(b.value=!1)}le(()=>{W(),window.addEventListener("resize",W,{passive:!0})}),ne(()=>{window.removeEventListener("resize",W)});function R(){k.error("无权限")}function I(n){const e=String(n||"");return e.startsWith("/")?e.startsWith("/users")?M.value:e.startsWith("/ai-assistant")?c.value:e.startsWith("/finance")?S.value:e.startsWith("/orders")?d.value?e.startsWith("/orders/import")||e.startsWith("/orders/create")?E.value:!0:!1:!0:!0}de(()=>o.query?.noauth,n=>{if(!n)return;k.error("无权限");const e={...o.query||{}};delete e.noauth,delete e.from,y.replace({path:o.path,query:e})});async function L(n){if(n==="__logout"){await K();return}if(!I(n)){R();return}if(n&&n!==o.path)try{await y.push(n)}catch{}}async function J(n){await L(n),v.value&&(b.value=!1)}async function N(n){const e=String(n||"");if(e){if(!I(e)){R();return}if(e!==o.path)try{await y.push(e)}catch{}}}async function K(){try{await te()}catch{}A.clearSession(),k.success("已退出登录"),await y.replace("/login")}return(n,e)=>{const l=r("el-menu-item"),V=r("el-sub-menu"),$=r("el-menu"),Y=r("el-aside"),j=r("el-drawer"),q=r("el-icon"),x=r("el-button"),Q=r("el-header"),X=r("router-view"),Z=r("el-main"),z=r("el-container");return w(),g(z,{class:"layout"},{default:t(()=>[v.value?(w(),g(j,{key:1,modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=p=>b.value=p),direction:"ltr",size:"240px","with-header":!1,"append-to-body":!0},{default:t(()=>[e[30]||(e[30]=a("div",{class:"aside-header mobile-aside-header"},[a("span",null,"订单管理系统")],-1)),s($,{"default-active":f(o).path,onSelect:J},{default:t(()=>[s(l,{index:"/users",disabled:!M.value},{default:t(()=>[...e[19]||(e[19]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"/ai-assistant",disabled:!c.value},{default:t(()=>[...e[20]||(e[20]=[a("span",null,"AI助手",-1)])]),_:1},8,["disabled"]),s(l,{index:"/channels"},{default:t(()=>[...e[21]||(e[21]=[a("span",null,"渠道管理",-1)])]),_:1}),s(l,{index:"/customers"},{default:t(()=>[...e[22]||(e[22]=[a("span",null,"客户管理",-1)])]),_:1}),s(V,{index:"orders",disabled:!d.value},{title:t(()=>[...e[23]||(e[23]=[a("span",null,"订单管理",-1)])]),default:t(()=>[s(l,{index:"/orders/import",disabled:!E.value},{default:t(()=>[...e[24]||(e[24]=[i("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/all",disabled:!d.value},{default:t(()=>[...e[25]||(e[25]=[i("所有订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/finished",disabled:!d.value},{default:t(()=>[...e[26]||(e[26]=[i("完成订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/unfinished",disabled:!d.value},{default:t(()=>[...e[27]||(e[27]=[i("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),s(l,{index:"/finance",disabled:!S.value},{default:t(()=>[...e[28]||(e[28]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"__logout"},{default:t(()=>[...e[29]||(e[29]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1},8,["modelValue"])):(w(),g(Y,{key:0,width:"200px"},{default:t(()=>[e[18]||(e[18]=a("div",{class:"aside-header"},[a("span",null,"订单管理系统")],-1)),s($,{"default-active":f(o).path,onSelect:L},{default:t(()=>[s(l,{index:"/users",disabled:!M.value},{default:t(()=>[...e[7]||(e[7]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"/ai-assistant",disabled:!c.value},{default:t(()=>[...e[8]||(e[8]=[a("span",null,"AI助手",-1)])]),_:1},8,["disabled"]),s(l,{index:"/channels"},{default:t(()=>[...e[9]||(e[9]=[a("span",null,"渠道管理",-1)])]),_:1}),s(l,{index:"/customers"},{default:t(()=>[...e[10]||(e[10]=[a("span",null,"客户管理",-1)])]),_:1}),s(V,{index:"orders",disabled:!d.value},{title:t(()=>[...e[11]||(e[11]=[a("span",null,"订单管理",-1)])]),default:t(()=>[s(l,{index:"/orders/import",disabled:!E.value},{default:t(()=>[...e[12]||(e[12]=[i("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/all",disabled:!d.value},{default:t(()=>[...e[13]||(e[13]=[i("所有订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/finished",disabled:!d.value},{default:t(()=>[...e[14]||(e[14]=[i("完成订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/unfinished",disabled:!d.value},{default:t(()=>[...e[15]||(e[15]=[i("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),s(l,{index:"/finance",disabled:!S.value},{default:t(()=>[...e[16]||(e[16]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"__logout"},{default:t(()=>[...e[17]||(e[17]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1})),s(z,null,{default:t(()=>[s(Q,{class:"header"},{default:t(()=>[a("div",oe,[v.value?(w(),g(x,{key:0,text:"",class:"menu-btn",onClick:e[1]||(e[1]=p=>b.value=!0),"aria-label":"打开菜单"},{default:t(()=>[s(q,null,{default:t(()=>[s(f(B))]),_:1})]),_:1})):U("",!0),a("span",ue,O(v.value?"订单管理系统":"欢迎使用系统"),1)]),a("div",re,[a("span",fe,"当前账号："+O(H.value||"-"),1)])]),_:1}),s(Z,{class:"main"},{default:t(()=>[s(X)]),_:1}),v.value?(w(),ie("div",ve,[s(x,{text:"",class:C(["nav-btn",{active:f(o).path.startsWith("/orders")}]),disabled:!d.value,onClick:e[2]||(e[2]=p=>N("/orders/all"))},{default:t(()=>[...e[31]||(e[31]=[i(" 订单 ",-1)])]),_:1},8,["class","disabled"]),s(x,{text:"",class:C(["nav-btn",{active:f(o).path==="/orders/unfinished"}]),disabled:!d.value,onClick:e[3]||(e[3]=p=>N("/orders/unfinished"))},{default:t(()=>[...e[32]||(e[32]=[i(" 未完成 ",-1)])]),_:1},8,["class","disabled"]),s(x,{text:"",class:C(["nav-btn",{active:f(o).path==="/orders/finished"}]),disabled:!d.value,onClick:e[4]||(e[4]=p=>N("/orders/finished"))},{default:t(()=>[...e[33]||(e[33]=[i(" 已完成 ",-1)])]),_:1},8,["class","disabled"]),s(x,{text:"",class:C(["nav-btn",{active:f(o).path.startsWith("/finance")}]),disabled:!S.value,onClick:e[5]||(e[5]=p=>N("/finance"))},{default:t(()=>[...e[34]||(e[34]=[i(" 财务 ",-1)])]),_:1},8,["class","disabled"]),s(x,{text:"",class:"nav-btn",onClick:e[6]||(e[6]=p=>b.value=!0)},{default:t(()=>[s(q,null,{default:t(()=>[s(f(B))]),_:1})]),_:1})])):U("",!0)]),_:1})]),_:1})}}},Me=se(pe,[["__scopeId","data-v-2109cc91"]]);export{Me as default};

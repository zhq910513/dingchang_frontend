import{b as X,u as Z}from"./vendor-vue-router-CVyACjsp.js";import{a as h}from"./auth-9daRAOLC.js";import{_ as ee,u as te,R as x}from"./index-6ncFfAxE.js";import{m as B,E as W}from"./vendor-element-plus-CtVxZ4Oy.js";import{c as u,r as D,q as se,Y as ae,o as le,G as g,H as t,ay as r,y as w,P as s,z as a,u as f,L as i,x as ne,J as I,M as O,C as N}from"./vendor-vue-fFWwKrgY.js";import"./http-CBIyYC5i.js";import"./vendor-axios-C0Zqfgkc.js";import"./vendor-pinia-CMXa-Za0.js";import"./vendor-lodash-rvV0CIkQ.js";import"./vendor-DWCz07M-.js";import"./vendor-dates-DVKSwKij.js";const de={class:"header-left"},ie={class:"header-title"},oe={class:"header-right"},re={class:"who"},ue={key:0,class:"mobile-bottom-nav"},fe={__name:"Dashboard",setup(ve){const y=X(),o=Z(),C=te(),_=u(()=>String(C.roleName||"").trim().toLowerCase()),U=u(()=>_.value===x.FINANCE),F=u(()=>_.value===x.SALES),T=u(()=>_.value===x.MARKET),G=u(()=>C.displayName),d=u(()=>!U.value),E=u(()=>d.value&&!T.value),S=u(()=>!F.value),M=u(()=>_.value===x.SUPER_ADMIN||_.value===x.MANAGER),v=D(!1),m=D(!1);function k(){v.value=typeof window<"u"&&window.innerWidth<=768,v.value||(m.value=!1)}se(()=>{k(),window.addEventListener("resize",k,{passive:!0})}),ae(()=>{window.removeEventListener("resize",k)});function L(){W.error("无权限")}function R(n){const e=String(n||"");return e.startsWith("/")?e.startsWith("/users")?M.value:e.startsWith("/finance")?S.value:e.startsWith("/orders")?d.value?e.startsWith("/orders/import")||e.startsWith("/orders/create")?E.value:!0:!1:!0:!0}le(()=>o.query?.noauth,n=>{if(!n)return;W.error("无权限");const e={...o.query||{}};delete e.noauth,delete e.from,y.replace({path:o.path,query:e})});async function V(n){if(n==="__logout"){await H();return}if(!R(n)){L();return}if(n&&n!==o.path)try{await y.push(n)}catch{}}async function P(n){await V(n),v.value&&(m.value=!1)}async function c(n){const e=String(n||"");if(e){if(!R(e)){L();return}if(e!==o.path)try{await y.push(e)}catch{}}}async function H(){try{await h()}catch{}C.clearSession(),W.success("已退出登录"),await y.replace("/login")}return(n,e)=>{const l=r("el-menu-item"),A=r("el-sub-menu"),$=r("el-menu"),J=r("el-aside"),K=r("el-drawer"),q=r("el-icon"),b=r("el-button"),Y=r("el-header"),j=r("router-view"),Q=r("el-main"),z=r("el-container");return w(),g(z,{class:"layout"},{default:t(()=>[v.value?(w(),g(K,{key:1,modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=p=>m.value=p),direction:"ltr",size:"240px","with-header":!1,"append-to-body":!0},{default:t(()=>[e[28]||(e[28]=a("div",{class:"aside-header mobile-aside-header"},[a("span",null,"订单管理系统")],-1)),s($,{"default-active":f(o).path,onSelect:P},{default:t(()=>[s(l,{index:"/users",disabled:!M.value},{default:t(()=>[...e[18]||(e[18]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"/channels"},{default:t(()=>[...e[19]||(e[19]=[a("span",null,"渠道管理",-1)])]),_:1}),s(l,{index:"/customers"},{default:t(()=>[...e[20]||(e[20]=[a("span",null,"客户管理",-1)])]),_:1}),s(A,{index:"orders",disabled:!d.value},{title:t(()=>[...e[21]||(e[21]=[a("span",null,"订单管理",-1)])]),default:t(()=>[s(l,{index:"/orders/import",disabled:!E.value},{default:t(()=>[...e[22]||(e[22]=[i("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/all",disabled:!d.value},{default:t(()=>[...e[23]||(e[23]=[i("所有订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/finished",disabled:!d.value},{default:t(()=>[...e[24]||(e[24]=[i("完成订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/unfinished",disabled:!d.value},{default:t(()=>[...e[25]||(e[25]=[i("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),s(l,{index:"/finance",disabled:!S.value},{default:t(()=>[...e[26]||(e[26]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"__logout"},{default:t(()=>[...e[27]||(e[27]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1},8,["modelValue"])):(w(),g(J,{key:0,width:"200px"},{default:t(()=>[e[17]||(e[17]=a("div",{class:"aside-header"},[a("span",null,"订单管理系统")],-1)),s($,{"default-active":f(o).path,onSelect:V},{default:t(()=>[s(l,{index:"/users",disabled:!M.value},{default:t(()=>[...e[7]||(e[7]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"/channels"},{default:t(()=>[...e[8]||(e[8]=[a("span",null,"渠道管理",-1)])]),_:1}),s(l,{index:"/customers"},{default:t(()=>[...e[9]||(e[9]=[a("span",null,"客户管理",-1)])]),_:1}),s(A,{index:"orders",disabled:!d.value},{title:t(()=>[...e[10]||(e[10]=[a("span",null,"订单管理",-1)])]),default:t(()=>[s(l,{index:"/orders/import",disabled:!E.value},{default:t(()=>[...e[11]||(e[11]=[i("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/all",disabled:!d.value},{default:t(()=>[...e[12]||(e[12]=[i("所有订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/finished",disabled:!d.value},{default:t(()=>[...e[13]||(e[13]=[i("完成订单",-1)])]),_:1},8,["disabled"]),s(l,{index:"/orders/unfinished",disabled:!d.value},{default:t(()=>[...e[14]||(e[14]=[i("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),s(l,{index:"/finance",disabled:!S.value},{default:t(()=>[...e[15]||(e[15]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),s(l,{index:"__logout"},{default:t(()=>[...e[16]||(e[16]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1})),s(z,null,{default:t(()=>[s(Y,{class:"header"},{default:t(()=>[a("div",de,[v.value?(w(),g(b,{key:0,text:"",class:"menu-btn",onClick:e[1]||(e[1]=p=>m.value=!0),"aria-label":"打开菜单"},{default:t(()=>[s(q,null,{default:t(()=>[s(f(B))]),_:1})]),_:1})):I("",!0),a("span",ie,O(v.value?"订单管理系统":"欢迎使用系统"),1)]),a("div",oe,[a("span",re,"当前账号："+O(G.value||"-"),1)])]),_:1}),s(Q,{class:"main"},{default:t(()=>[s(j)]),_:1}),v.value?(w(),ne("div",ue,[s(b,{text:"",class:N(["nav-btn",{active:f(o).path.startsWith("/orders")}]),disabled:!d.value,onClick:e[2]||(e[2]=p=>c("/orders/all"))},{default:t(()=>[...e[29]||(e[29]=[i(" 订单 ",-1)])]),_:1},8,["class","disabled"]),s(b,{text:"",class:N(["nav-btn",{active:f(o).path==="/orders/unfinished"}]),disabled:!d.value,onClick:e[3]||(e[3]=p=>c("/orders/unfinished"))},{default:t(()=>[...e[30]||(e[30]=[i(" 未完成 ",-1)])]),_:1},8,["class","disabled"]),s(b,{text:"",class:N(["nav-btn",{active:f(o).path==="/orders/finished"}]),disabled:!d.value,onClick:e[4]||(e[4]=p=>c("/orders/finished"))},{default:t(()=>[...e[31]||(e[31]=[i(" 已完成 ",-1)])]),_:1},8,["class","disabled"]),s(b,{text:"",class:N(["nav-btn",{active:f(o).path.startsWith("/finance")}]),disabled:!S.value,onClick:e[5]||(e[5]=p=>c("/finance"))},{default:t(()=>[...e[32]||(e[32]=[i(" 财务 ",-1)])]),_:1},8,["class","disabled"]),s(b,{text:"",class:"nav-btn",onClick:e[6]||(e[6]=p=>m.value=!0)},{default:t(()=>[s(q,null,{default:t(()=>[s(f(B))]),_:1})]),_:1})])):I("",!0)]),_:1})]),_:1})}}},Ce=ee(fe,[["__scopeId","data-v-922d214a"]]);export{Ce as default};

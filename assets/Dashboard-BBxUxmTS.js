import{b as P,u as G}from"./vendor-vue-router-o2a2TmKO.js";import{a as H}from"./auth-BqM3s_5E.js";import{_ as J,u as K}from"./index-ql1pe5O8.js";import{m as M,E as C}from"./vendor-element-plus-nv6hIq5t.js";import{c as b,r as R,q as Y,Y as j,o as Q,G as x,H as s,ay as r,y as v,P as t,z as a,u as o,L as d,x as X,J as V,M as U,C as g}from"./vendor-vue-CZOMRj4y.js";import"./http-DGyH82Tn.js";import"./vendor-axios-C0Zqfgkc.js";import"./vendor-pinia--LqfdQ-h.js";import"./vendor-lodash-rvV0CIkQ.js";import"./vendor-DWCz07M-.js";import"./vendor-dates-DVKSwKij.js";const Z={class:"header-left"},h={class:"header-title"},ee={class:"header-right"},se={class:"who"},te={key:0,class:"mobile-bottom-nav"},ne={__name:"Dashboard",setup(ae){const w=P(),i=G(),S=K(),y=b(()=>String(S.roleName||"").trim().toLowerCase());b(()=>y.value===ROLE.FINANCE),b(()=>y.value===ROLE.SALES),b(()=>y.value===ROLE.MARKET),b(()=>y.value===ROLE.SUPER_ADMIN);const $=b(()=>S.displayName),u=R(!1),p=R(!1);function _(){u.value=typeof window<"u"&&window.innerWidth<=768,u.value||(p.value=!1)}Y(()=>{_(),window.addEventListener("resize",_,{passive:!0}),document.body.classList.add("app-shell-lock")}),j(()=>{window.removeEventListener("resize",_),document.body.classList.remove("app-shell-lock")});function E(){C.error("无权限")}function N(n){const e=String(n||"");return e.startsWith("/")?e.startsWith("/users")?canUsers.value:e.startsWith("/ai-assistant")?canAiAssistant.value:e.startsWith("/finance")?canFinance.value:e.startsWith("/orders")?canOrders.value?e.startsWith("/orders/import")||e.startsWith("/orders/create")?canOrderWrite.value:!0:!1:!0:!0}Q(()=>i.query?.noauth,n=>{if(!n)return;C.error("无权限");const e={...i.query||{}};delete e.noauth,delete e.from,w.replace({path:i.path,query:e})});async function W(n){if(n==="__logout"){await z();return}if(!N(n)){E();return}if(n&&n!==i.path)try{await w.push(n)}catch{}}async function q(n){await W(n),u.value&&(p.value=!1)}async function O(n){const e=String(n||"");if(e){if(!N(e)){E();return}if(e!==i.path)try{await w.push(e)}catch{}}}async function z(){try{await H()}catch{}S.clearSession(),C.success("已退出登录"),await w.replace("/login")}return(n,e)=>{const l=r("el-menu-item"),L=r("el-sub-menu"),k=r("el-menu"),B=r("el-aside"),F=r("el-drawer"),c=r("el-icon"),m=r("el-button"),D=r("el-header"),I=r("router-view"),T=r("el-main"),A=r("el-container");return v(),x(A,{class:"layout"},{default:s(()=>[u.value?(v(),x(F,{key:1,modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=f=>p.value=f),direction:"ltr",size:"240px","with-header":!1,"append-to-body":!0},{default:s(()=>[e[30]||(e[30]=a("div",{class:"aside-header mobile-aside-header"},[a("span",null,"订单管理系统")],-1)),t(k,{"default-active":o(i).path,onSelect:q},{default:s(()=>[t(l,{index:"/users",disabled:!n.canUsers},{default:s(()=>[...e[19]||(e[19]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),t(l,{index:"/ai-assistant",disabled:!n.canAiAssistant},{default:s(()=>[...e[20]||(e[20]=[a("span",null,"报价助手",-1)])]),_:1},8,["disabled"]),t(l,{index:"/channels"},{default:s(()=>[...e[21]||(e[21]=[a("span",null,"渠道管理",-1)])]),_:1}),t(l,{index:"/customers"},{default:s(()=>[...e[22]||(e[22]=[a("span",null,"客户管理",-1)])]),_:1}),t(L,{index:"orders",disabled:!n.canOrders},{title:s(()=>[...e[23]||(e[23]=[a("span",null,"订单管理",-1)])]),default:s(()=>[t(l,{index:"/orders/import",disabled:!n.canOrderWrite},{default:s(()=>[...e[24]||(e[24]=[d("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/all",disabled:!n.canOrders},{default:s(()=>[...e[25]||(e[25]=[d("所有订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/finished",disabled:!n.canOrders},{default:s(()=>[...e[26]||(e[26]=[d("完成订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/unfinished",disabled:!n.canOrders},{default:s(()=>[...e[27]||(e[27]=[d("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),t(l,{index:"/finance",disabled:!n.canFinance},{default:s(()=>[...e[28]||(e[28]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),t(l,{index:"__logout"},{default:s(()=>[...e[29]||(e[29]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1},8,["modelValue"])):(v(),x(B,{key:0,width:"200px"},{default:s(()=>[e[18]||(e[18]=a("div",{class:"aside-header"},[a("span",null,"订单管理系统")],-1)),t(k,{"default-active":o(i).path,onSelect:W},{default:s(()=>[t(l,{index:"/users",disabled:!n.canUsers},{default:s(()=>[...e[7]||(e[7]=[a("span",null,"账号管理",-1)])]),_:1},8,["disabled"]),t(l,{index:"/ai-assistant",disabled:!n.canAiAssistant},{default:s(()=>[...e[8]||(e[8]=[a("span",null,"报价助手",-1)])]),_:1},8,["disabled"]),t(l,{index:"/channels"},{default:s(()=>[...e[9]||(e[9]=[a("span",null,"渠道管理",-1)])]),_:1}),t(l,{index:"/customers"},{default:s(()=>[...e[10]||(e[10]=[a("span",null,"客户管理",-1)])]),_:1}),t(L,{index:"orders",disabled:!n.canOrders},{title:s(()=>[...e[11]||(e[11]=[a("span",null,"订单管理",-1)])]),default:s(()=>[t(l,{index:"/orders/import",disabled:!n.canOrderWrite},{default:s(()=>[...e[12]||(e[12]=[d("导入 / 创建订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/all",disabled:!n.canOrders},{default:s(()=>[...e[13]||(e[13]=[d("所有订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/finished",disabled:!n.canOrders},{default:s(()=>[...e[14]||(e[14]=[d("完成订单",-1)])]),_:1},8,["disabled"]),t(l,{index:"/orders/unfinished",disabled:!n.canOrders},{default:s(()=>[...e[15]||(e[15]=[d("未完成订单",-1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),t(l,{index:"/finance",disabled:!n.canFinance},{default:s(()=>[...e[16]||(e[16]=[a("span",null,"财务管理",-1)])]),_:1},8,["disabled"]),t(l,{index:"__logout"},{default:s(()=>[...e[17]||(e[17]=[a("span",null,"退出登录",-1)])]),_:1})]),_:1},8,["default-active"])]),_:1})),t(A,{class:"right-shell"},{default:s(()=>[t(D,{class:"header"},{default:s(()=>[a("div",Z,[u.value?(v(),x(m,{key:0,text:"",class:"menu-btn",onClick:e[1]||(e[1]=f=>p.value=!0),"aria-label":"打开菜单"},{default:s(()=>[t(c,null,{default:s(()=>[t(o(M))]),_:1})]),_:1})):V("",!0),a("span",h,U(u.value?"订单管理系统":"欢迎使用系统"),1)]),a("div",ee,[a("span",se,"当前账号："+U($.value||"-"),1)])]),_:1}),t(T,{class:"main"},{default:s(()=>[t(I)]),_:1}),u.value?(v(),X("div",te,[t(m,{text:"",class:g(["nav-btn",{active:o(i).path.startsWith("/orders")}]),disabled:!n.canOrders,onClick:e[2]||(e[2]=f=>O("/orders/all"))},{default:s(()=>[...e[31]||(e[31]=[d(" 订单 ",-1)])]),_:1},8,["class","disabled"]),t(m,{text:"",class:g(["nav-btn",{active:o(i).path==="/orders/unfinished"}]),disabled:!n.canOrders,onClick:e[3]||(e[3]=f=>O("/orders/unfinished"))},{default:s(()=>[...e[32]||(e[32]=[d(" 未完成 ",-1)])]),_:1},8,["class","disabled"]),t(m,{text:"",class:g(["nav-btn",{active:o(i).path==="/orders/finished"}]),disabled:!n.canOrders,onClick:e[4]||(e[4]=f=>O("/orders/finished"))},{default:s(()=>[...e[33]||(e[33]=[d(" 已完成 ",-1)])]),_:1},8,["class","disabled"]),t(m,{text:"",class:g(["nav-btn",{active:o(i).path.startsWith("/finance")}]),disabled:!n.canFinance,onClick:e[5]||(e[5]=f=>O("/finance"))},{default:s(()=>[...e[34]||(e[34]=[d(" 财务 ",-1)])]),_:1},8,["class","disabled"]),t(m,{text:"",class:"nav-btn",onClick:e[6]||(e[6]=f=>p.value=!0)},{default:s(()=>[t(c,null,{default:s(()=>[t(o(M))]),_:1})]),_:1})])):V("",!0)]),_:1})]),_:1})}}},we=J(ne,[["__scopeId","data-v-b711bac4"]]);export{we as default};
